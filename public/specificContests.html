<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" href="assets/images/becoder.png" type="image/gif" sizes="16x16">
  <title>becoder</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
  <!-- Bootstrap core CSS -->
  <link href="assets/library/mdb/css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="assets/library/mdb/css/mdb.min.css" rel="stylesheet">
  <!-- JQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Bootstrap tooltips -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="assets/library/mdb/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="assets/library/mdb/js/mdb.min.js"></script>
  <!--  firebase config-->
      <script src="/__/firebase/5.6.0/firebase-app.js"></script>
      <script src="/__/firebase/5.6.0/firebase-auth.js"></script>
      <script src="/__/firebase/5.6.0/firebase-firestore.js"></script>
      <script src="/__/firebase/5.6.0/firebase-storage.js"></script>
      <script src="/__/firebase/5.6.0/firebase-messaging.js"></script>
      <!--  firebase config-->
  <script src="/__/firebase/init.js"></script>

  <style>
  html, body {
    max-width: 100%;
    overflow-x: hidden;
  }
      .card{
          background-color: #fafafa ;
      }
    /*becoder style*/
    .becoder_tutorial_header > h3{
      filter:blur(1px);
      font-size: 20px;
    }
    .navbar .navbar-brand{
      margin-left:10% !important;
    }
    .navbar-nav > li{
      padding-left: 10px;
      padding-right: 10px;
    }
    .ml-auto .dropdown-menu {
      margin-top: 7px !important;
     left: auto !important;
     right: 0px;
    }
    /* TEMPLATE STYLES */

     main {
         padding-bottom: 2rem;
     }

     .extra-margins {
         margin-top: 1rem;
         margin-bottom: 2.5rem;
     }

     .jumbotron {
         text-align: center;
     }

     .navbar {
         background-color: #3b295a;
     }

     footer.page-footer {
         background-color: #3b295a;
         margin-top: 2rem;
     }
     .navbar .btn-group .dropdown-menu a:hover {
         color: #000 !important;
     }
     .navbar .btn-group .dropdown-menu a:active {
         color: #fff !important;
     }

  /*login/register*/
    .social {
        float: left;
        margin: 0 auto 30px;
        text-align: center;
    }

    .social .circle{
           width: 50px;
       height: 50px;
       -moz-border-radius: 70px;
       -webkit-border-radius: 70px;
       border-radius: 70px;

        background-color: #EEEEEE;
        color: #FFFFFF;
        display: inline-block;
        margin: 5px 13px;
        padding: 15px;
    }
     .social .circle .fab{
        font-size: 20px;
    }
    .social .facebook{
        background-color: #455CA8;
        color: #FFFFFF;
    }
    .social .google{
        background-color: #F74933;
    }
    .social .github{
        background-color: #403A3A;
    }
    .facebook:hover{
        background-color: #6E83CD;
    }
    .google:hover{
        background-color: #FF7566;
    }
    .github:hover{
        background-color: #4D4D4d;;
    }
    .login_connect_with{
        text-align: center;
    }
    .contest_reg_button{
        border: 1px solid black;
        padding: 5px;
        padding-left: 25px;
        padding-right: 25px;
        border-radius: 5px;
        font-size: 20px;
        z-index: 0;
      }
.no_padding{
  padding: 0;
  margin: 0;
}
   </style>

<style>
	.submit-form{
    margin-top: 20px;
}

.bar_container {
  width: 200px;
  overflow: hidden;
}

.bar_horizontal .progress-barc {
  height: 27px;
  width: 100%;
}

.bar_horizontal .progress-track {
  position: relative;
  width: 100%;
  height: 20px;
  background: #ebebeb;
}

.bar_horizontal .progress-fill {
  position: relative;
  background: #007E33;
  height: 20px;
  width: 50%;
  color: #fff;
  text-align: center;
  font-family: "Lato","Verdana",sans-serif;
  font-size: 12px;
  line-height: 20px;
}

.bar_horizontal .progress-track {
  position: relative;
  width: 100%;
  height: 20px;
  background: #ebebeb;
}

.bar_horizontal2 .progress-fill2 {
  position: relative;
  background: #CC0000;
  height: 20px;
  width: 50%;
  color: #fff;
  text-align: center;
  font-family: "Lato","Verdana",sans-serif;
  font-size: 12px;
  line-height: 20px;
}

.bar_horizontal3 .progress-fill3 {
  position: relative;
  background: #2E2E2E;
  height: 20px;
  width: 50%;
  color: #fff;
  text-align: center;
  font-family: "Lato","Verdana",sans-serif;
  font-size: 12px;
  line-height: 20px;
}

.rounded_bar .progress-track,
.rounded_bar .progress-fill {
  border-radius: 3px;
  box-shadow: inset 0 0 5px rgba(0,0,0,.2);
}


</style>
</head>
    <body class="grey lighten-3">

      <!--Main Navigation-->
      <header>
        <!--Navbar-->
        <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-blue scrolling-navbar">
          <a class="navbar-brand" href="index.html">
            <img src="assets/images/becoder.png" width="30" height="30" class="d-inline-block align-top" alt="">
          </a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#becoderNavbarToggle" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="becoderNavbarToggle">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                  <li class="nav-item active">
                    <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Practice</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="contests.html">Contests</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Resource</a>
                  </li>
                  <li class="nav-item" style="padding-right:20px;padding-left:20px">

                  </li>

                </ul>
                <ul class="navbar-nav ml-auto">
                  <li class="nav-item">
                    <a class="nav-link" href="#">Leaderboard</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Notifications</a>
                  </li>

                  <li class="nav-item" id="navbar-login-signin-button" hidden>
                    <a class="nav-link" data-toggle="modal" data-target="#modalLRForm" href="#">Login/Register</a>
                  </li>

                  <li class="nav-item dropdown" id="navbar-user-item" hidden>
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <img id="nav-user-pic" width="30" height="30" class="d-inline-block align-top" alt="">
                      <span id="nav-user-name">becoder</span></a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item" href="#">Ranking</a>
                      <a class="dropdown-item" href="userProfile.html">Profile</a>
                      <a class="dropdown-item" href="#">Submission</a>
                      <a class="dropdown-item" href="#">Note</a>
                      <a class="dropdown-item" href="#">Setting</a>
                      <a class="dropdown-item" href="administration/contests.html">Administration</a>
                      <a class="dropdown-item" id="logout" href="#">Logout</a>

                    </div>
                  </li>
                </ul>
              </div>
            </nav>
        <!--/.Navbar-->

        </header>


        <!--Modal: Login / Register Form-->
      <div class="modal fade" id="modalLRForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog cascading-modal" role="document">
        <!--Content-->
        <div class="modal-content">

          <!--Modal cascading tabs-->
          <div class="modal-c-tabs">

            <!-- Nav tabs -->
            <ul class="nav nav-tabs md-tabs tabs-2 light-blue darken-3" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#panel7" role="tab"><i class="fas fa-user mr-1"></i>
                  Login</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#panel8" role="tab"><i class="fas fa-user-plus mr-1"></i>
                  Register</a>
              </li>
            </ul>

            <!-- Tab panels -->
            <div class="tab-content">
              <!--Panel 7-->
              <div class="tab-pane fade in show active" id="panel7" role="tabpanel">

                <!--Body-->
                <div class="modal-body mb-1">
                  <div class="md-form form-sm mb-5">
                    <i class="fas fa-envelope prefix"></i>
                    <input type="email" placeholder="email or username" id="user-sign-in-email" class="form-control form-control-sm validate">
                  </div>

                  <div class="md-form form-sm mb-4">
                    <i class="fas fa-lock prefix"></i>
                    <input type="password" placeholder="password" id="user-sign-in-password" class="form-control form-control-sm validate">
                  </div>
                  <div class="text-center mt-2">
                    <button class="btn btn-info"  id= "sign-in-with-email" >Log in <i class="fas fa-sign-in ml-1"></i></button>
                  </div>
                </div>
                <!--Footer-->
                <div class="login_connect_with">
                    Or Connect With
                  </div>
                <!--Footer-->
                <div class="modal-footer">
                  <div class="social">
                    <a class="circle github" href="#">
                        <i class="fab fa-github"></i>
                    </a>
                    <a id="google_login" class="circle google" href="#">
                        <i class="fab fa-google"></i>
                    </a>
                    <a id="facebook_login" class="circle facebook" href="#">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                </div>
                </div>

              </div>
              <!--/.Panel 7-->

              <!--Panel 8-->
              <div class="tab-pane fade" id="panel8" role="tabpanel">

                <!--Body-->
                <div class="modal-body">
                  <div class="md-form form-sm mb-5">
                    <i class="fas fa-envelope prefix"></i>
                    <input type="email" placeholder="email" id="user-sign-up-email" class="form-control form-control-sm validate">

                  </div>
                  <div class="md-form form-sm mb-5">
                    <i class="fas fa-user prefix"></i>
                    <input type="text" placeholder="username" id="user-sign-up-username" class="form-control form-control-sm validate">

                  </div>
                  <div class="md-form form-sm mb-5">
                    <i class="fas fa-lock prefix"></i>
                    <input type="password" placeholder="password" id="user-sign-up-password" class="form-control form-control-sm validate">

                  </div>

                  <div class="md-form form-sm mb-4">
                    <i class="fas fa-lock prefix"></i>
                    <input type="password" placeholder="Repeat password" id="modalLRInput14" class="form-control form-control-sm validate">
                  </div>
                <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="defaultUnchecked">
                    <label class="custom-control-label" for="defaultUnchecked">Accept the<a href="#" class="green-text font-weight-bold">
                                  Terms and Conditions</a></label>
                </div>
                  <div class="text-center form-sm mt-2">
                    <button class="btn btn-info" id="sign-up-with-email">Sign up <i class="fas fa-sign-in ml-1"></i></button>
                  </div>

                </div>
                  <div class="login_connect_with">
                    Or Connect With
                  </div>
                <!--Footer-->
                <div class="modal-footer">
                  <div class="social">
                    <a class="circle github" href="#">
                        <i class="fab fa-github"></i>
                    </a>
                    <a id="google_login" class="circle google" href="#">
                        <i class="fab fa-google"></i>
                    </a>
                    <a id="facebook_login" class="circle facebook" href="#">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                </div>
                </div>
              </div>
              <!--/.Panel 8-->
            </div>

          </div>
        </div>
        <!--/.Content-->
      </div>
    </div>


<main>
    <div class="container-fluid">

      <!--Section: Post-->
    	<section class="mt-4">
        	<div class="row wow fadeIn" data-wow-delay="0.2s">
          		<div class="col-md-12">
            		<div class="jumbotron">
            			<ul class="nav nav-tabs" id="myTab" role="tablist">
  							<li class="nav-item">
    							<a class="nav-link active" id="problem-tab" data-toggle="tab" href="#problem" role="tab" aria-controls="problem"
      							aria-selected="true">Problems</a>
  							</li>
  							<li class="nav-item">
    							<a class="nav-link" id="submit-tab" data-toggle="tab" href="#submit" role="tab" aria-controls="submit"
      							aria-selected="false">Submit</a>
  							</li>
  							<li class="nav-item">
    							<a class="nav-link" id="mySubmission-tab" data-toggle="tab" href="#mySubmission" role="tab" aria-controls="mySubmission"
      							aria-selected="false">My Submission</a>
  							</li>
  							<li class="nav-item">
    							<a class="nav-link" id="allSubmission-tab" data-toggle="tab" href="#allSubmission" role="tab" aria-controls="allSubmission"
      							aria-selected="false">All Submission</a>
  							</li>
  							<li class="nav-item">
    							<a class="nav-link" id="standing-tab" data-toggle="tab" href="#standing" role="tab" aria-controls="standing"
      							aria-selected="false">Standing</a>
  							</li>
						</ul>

						<!-- Tab Contents -->
						<div class="tab-content" id="myTabContent">
  							<div class="tab-pane fade show active" id="problem" role="tabpanel" aria-labelledby="problem-tab">

  							<div class="table-responsive">
  							<!--Table-->
  								<table class="table table-striped">


   							 <!--Table body-->
    								<tbody id="contestProblemListTableM">


    								</tbody>
    							<!--Table body-->
  								</table>
  							<!--Table-->
							</div>

  							</div>

  							<div class="tab-pane fade " id="submit" role="tabpanel" aria-labelledby="submit-tab">
  							<!-- Horizontal material form -->
<form class="submit-form">
  <!-- Grid row -->
  <div class="form-group row">
    <!-- Material input -->
    <label for="problemId" class="col-sm-2 col-form-label">Problem Id</label>
    <div class="col-sm-8">
      <select class="browser-default custom-select custom-select-lg mb-3" id="contestProblemIdSelcetOpForSubmit">

      </select>
    </div>
  </div>
  <!-- Grid row -->

  <!-- Grid row -->
  <div class="form-group row">
    <!-- Material input -->
    <label for="problemId" class="col-sm-2 col-form-label">Language</label>
    <div class="col-sm-8">
      <select class="custom-select custom-select-sm" id="allProblemLanguagesSubmitOption">
        <option value="0" disabled selected>Choose Language</option>

      </select>
    </div>
  </div>

  <!-- Grid row -->
<div class="form-group row">
    <!-- Material input -->
  <label for="problemId" class="col-sm-2 col-form-label">Code:</label>
  <div class="form-group col-sm-8 shadow-textarea">
  <textarea class="form-control z-depth-1" name="sourceCode" rows="10"  cols="100" placeholder="Place your Code here..."></textarea>
  </div>
</div>

  <!-- Grid row -->
 <div class="form-group row">
    <!-- Material input -->
  <label for="problemId" class="col-sm-2 col-form-label">.. or file Upload:</label>
  <div class="form-group shadow-textarea">
  <input type="file">
</div>
</div>
  <!-- Grid row -->
<a href="#"><button id="submitProblemCode" type="button" class="btn btn-primary">Submit Code</button></a>

</form>
<!-- Horizontal material form -->
  							</div>

  							<div class="tab-pane fade " id="mySubmission" role="tabpanel" aria-labelledby="mySubmission-tab">
  							<div class="table-responsive">
  							<!--Table-->
  								<table class="table table-striped">

  									<!--Table head-->
								    <thead>
								      <tr>
								        <th>#</th>
								        <th>Problem Name</th>
								        <th>Status</th>
								        <th>Language</th>
								        <th>Run Time</th>
								        <th>Submission Date</th>
								      </tr>
								    </thead>
								    <!--Table head-->


   							 <!--Table body-->
    								<tbody id="mySubmissionTableBody">

    								</tbody>
    							<!--Table body-->
  								</table>
  							<!--Table-->
							</div>


  							</div>

  							<div class="tab-pane fade " id="allSubmission" role="tabpanel" aria-labelledby="allSubmission-tab">
  							<div class="table-responsive">
  							<!--Table-->
  								<table class="table table-striped">

                    <thead>
                      <tr>
                        <th>#</th>
                        <th>Problem Name</th>
                        <th>Status</th>
                        <th>Language</th>
                        <th>Run Time</th>
                        <th>Submission Date</th>
                        <th>Submit by</th>
                      </tr>
                    </thead>
                    <!--Table head-->
                 <!--Table body-->
                    <tbody id="allSubmissionTableBody">

                    </tbody>
    							<!--Table body-->
  								</table>
  							<!--Table-->
							</div>
  							</div>

  							<div class="tab-pane fade " id="standing" role="tabpanel" aria-labelledby="standing-tab">
                  <table class="table table-sm  table-hover">
                    <thead>
                      <tr id="standingTableHeader">

                      </tr>
                    </thead>
                    <tbody id="standingTableBody">

                    </tbody>
                  </table>
  							</div>
						</div>
						<!-- End tab Contents -->
            		</div>
        		</div>
    		</div>
    	</section>
	</div>
</main>


  <!--Footer layout-->


  <!--End Footer Layout-->
  <footer class="page-footer text-center text-md-left mt-4 pt-4">
    <!--Footer links-->
    <div class="container-fluid">
      <div class="row">
        <!--First column-->
        <div class="col-lg-3 col-md-6 ml-auto">
          <h5 class="title mb-3"><strong>About becoder</strong></h5>
          <p>In mathematics and computer science, an algorithm is an unambiguous
             specification of how to solve a class of problems.</p>
          <p>In mathematics and computer science, an algorithm is an unambiguous
            specification of how to solve a class of problems.</p>
        </div>
        <!--/.First column-->
        <hr class="w-100 clearfix d-sm-none">
        <!--Second column-->
        <div class="col-lg-2 col-md-6 ml-auto mb-4">
          <h5 class="title mb-3"><strong>First column</strong></h5>
          <ul class="list-unstyled">
            <li>
              <a href="#!">Link 1</a>
            </li>
            <li>
              <a href="#!">Link 2</a>
            </li>
            <li>
              <a href="#!">Link 3</a>
            </li>
            <li>
              <a href="#!">Link 4</a>
            </li>
          </ul>
        </div>
        <!--/.Second column-->
        <hr class="w-100 clearfix d-sm-none">
        <!--Third column-->
        <div class="col-lg-2 col-md-6 ml-auto mb-4">
          <h5 class="title mb-3"><strong>Second column</strong></h5>
          <ul class="list-unstyled">
            <li>
              <a href="#!">Link 1</a>
            </li>
            <li>
              <a href="#!">Link 2</a>
            </li>
            <li>
              <a href="#!">Link 3</a>
            </li>
            <li>
              <a href="#!">Link 4</a>
            </li>
          </ul>
        </div>
        <!--/.Third column-->
        <hr class="w-100 clearfix d-sm-none">
        <!--Fourth column-->
        <div class="col-lg-2 col-md-6 ml-auto mb-4">
          <h5 class="title mb-3"><strong>Third column</strong></h5>
          <ul class="list-unstyled">
            <li>
              <a href="#!">Link 1</a>
            </li>
            <li>
              <a href="#!">Link 2</a>
            </li>
            <li>
              <a href="#!">Link 3</a>
            </li>
            <li>
              <a href="#!">Link 4</a>
            </li>
          </ul>
        </div>
        <!--/.Fourth column-->
      </div>
    </div>
    <!--/.Footer links-->
    <hr>

    <!--Copyright-->
    <div class="footer-copyright py-3 text-center">
      <div class="containter-fluid">
        © 2019 Copyright: <a href="index.html"> becoder.com </a>
      </div>
    </div>
    <!--/.Copyright-->
  </footer>
  <!--/.Footer-->
  <script type="text/javascript" src="bin/becoder.js"></script>

  <script>
  new WOW().init();
  </script>
  <script>
  "use strict";
  var queryString = decodeURIComponent(window.location.search);
  const contestIdRef = queryString.substring(1);
  // Checks that Firebase has been imported.
  checkSetup();
  var signInButtonElement = document.getElementById('google_login');

  var userSignUpEmail = document.getElementById('user-sign-up-email');
  var userSignUpPass = document.getElementById('user-sign-up-password');
  var userSignUpUsername = document.getElementById('user-sign-up-username');

  var signUpWithEmailPasswordButton = document.getElementById('sign-up-with-email');
  var signInWithEmailPasswordButton = document.getElementById('sign-in-with-email');
  var signInSignUpNavButton = document.getElementById('navbar-login-signin-button');
  var logoutButton = document.getElementById('logout');
  var userNavItem = document.getElementById('navbar-user-item');
  var userNavName = document.getElementById('nav-user-name');
  var userNavPic = document.getElementById('nav-user-pic');

  signInButtonElement.addEventListener('click', signIn);
  signUpWithEmailPasswordButton.addEventListener('click',signUpWithEmailPassword);
  signInWithEmailPasswordButton.addEventListener('click',signInWithEmailPassword);
  logoutButton.addEventListener('click',signOut);

  $(document).ready(function(){
    initFirebaseAuthShowContest();
  });


  function initFirebaseAuthShowContest(){
    auth.onAuthStateChanged(function(user) {
      authStateObserverShowContest(user);
    });
  }

  function authStateObserverShowContest(user) {
    if (user) { // User is signed in!
      // Get the signed-in user's profile pic and name.
      var profilePicUrl = getProfilePicUrl();
      var userName = getUserName();
      userNavItem.removeAttribute('hidden');
      userNavName.textContent = userName;
      userNavPic.src = getProfilePicUrl();
      signInSignUpNavButton.setAttribute('hidden', 'true');
      getAllContestProblem(contestIdRef);
      getMySubmissionAll(contestIdRef);
      getAllSubmission(contestIdRef);
      updateSatndingTableData(contestIdRef);
    } else { // User is signed out!
      // Hide user's profile and sign-out button.
      userNavItem.setAttribute('hidden', 'true');
      signInSignUpNavButton.removeAttribute('hidden');
    }
  }

  function getAllContestProblem(mContestId){
    firestore.collection("contests").doc(mContestId).collection("contestProblems")
    .orderBy("problemTag")
    .onSnapshot(function(snapshot) {
      $("#contestProblemListTableM").empty();
      $("#contestProblemIdSelcetOpForSubmit").empty();
      var count = 65;
      snapshot.forEach(function(doc) {
        var data = doc.data();
        var formChar = String.fromCharCode(count);
        var tableRowConProb = '<tr style="padding:0!important;margin:0!important">\
          <th scope="row" style="padding-top:50px!important">'+formChar+' .</th>\
          <td style="padding-top:45px!important;font-size:25px;">\
            <a href="specificProblem.html?'+data.contestProblemId+'" class="">\
            <strong>'+data.problemName+'</strong></a>\
          </td>\
          <td style="padding-top:28px!important"><!-- Horizontal, rounded -->\
            <div class="bar_container bar_horizontal rounded_bar">\
            <div class="progress-barc horizontal">\
            <div class="progress-track">\
              <div class="progress-fill">\
                <span>70%</span>\
              </div>\
            </div>\
            </div>\
            <div class="progress-barc bar_horizontal2">\
            <div class="progress-track">\
              <div class="progress-fill2">\
                <span>20%</span>\
              </div>\
            </div>\
            </div>\
            <div class="progress-barc bar_horizontal3">\
            <div class="progress-track">\
              <div class="progress-fill3">\
                <span>10%</span>\
              </div>\
            </div>\
            </div>\
            </div>\
          </td>\
          <td style="padding-top:20px!important">\
            <h5><span class="badge badge-pill success-color-dark">9382</span></h5>\
            <h5><span class="badge badge-pill badge-danger">145</span></h5>\
            <h5><span class="badge badge-pill elegant-color">145</span></h5>\
          </td>\
          <td style="padding-top:45px!important">\
            <a href="#">\
            <button type="button" class="btn btn-secondary btn-sm">Submit</button>\
            </a>\
          </td>\
        </tr>'
        $("#contestProblemListTableM").append(tableRowConProb);

        // progress bar
        $('.bar_horizontal .progress-fill span').each(function(){
        var percent = $(this).html();
          $(this).parent().css('width', percent);
        });
        $('.bar_horizontal2 .progress-fill2 span').each(function(){
          var percent = $(this).html();
          $(this).parent().css('width', percent);
        });
        $('.bar_horizontal3 .progress-fill3 span').each(function(){
          var percent = $(this).html();
          $(this).parent().css('width', percent);
        });

        var conPIdOp = '<option value="'+doc.id+'">'+formChar+". "+data.problemName+'</option>'
        $("#contestProblemIdSelcetOpForSubmit").append(conPIdOp);
        console.log(doc.id);
        count++;
      });
      $('#contestProblemIdSelcetOpForSubmit').on('change', function() {
        getAllProblemLanguagesForSubmitOption(this.value);
      });
      getAllProblemLanguagesForSubmitOption($('#contestProblemIdSelcetOpForSubmit').val());
      }, function(error) {
         console.log("Error getting documents: ", error);
      });
  }
  function getAllProblemLanguagesForSubmitOption(values){
    var res = values.split("$data$")
    var problemIdRefs = res[0];
    console.log(problemIdRefs);
    firestore.collection('problemsTest').doc(problemIdRefs)
    .collection("problemLanguages")
    .where('languageCheck', '==', true)
    .orderBy("languageId")
    .onSnapshot(function(snapshot) {
      $("#allProblemLanguagesSubmitOption").empty();
      snapshot.forEach(function(doc) {
        var data = doc.data();
        var optionLang = '<option value="'+data.languageId+'">\
        '+data.languageName+'</option>';
        console.log(optionLang);
        $("#allProblemLanguagesSubmitOption").append(optionLang);
      });
      }, function(error) {
          console.log(error);
      });
  }
  function getMySubmissionAll(contestIdRef){
      firestore.collection('contests').doc(contestIdRef)
      .collection("submissions")
      .where('submitBy', '==', getCurrentUserId())
      .orderBy("submissionTime","desc")
      .onSnapshot(function(snapshot) {
        $("#mySubmissionTableBody").empty();
        var count = 1;
        snapshot.forEach(function(doc) {
          console.log(doc.data());
          var data = doc.data();
          var submissionStatus = data.status;
          var submissionStatusID = submissionStatus.id;
          var submissionBadegeClass ;
          var runTime ;
          if (submissionStatusID==3) {
            submissionBadegeClass = "badge-default";
            runTime = data.time;
          }
          else if (submissionStatusID==4) {
            submissionBadegeClass = "badge-danger";
            runTime = data.time;
          }
          else  {
            submissionBadegeClass =  "badge-warning";
            runTime ='<span class="badge badge-warning">\
            <i class="fas fa-times"></i></span>';

          }
            console.log(data.status.id);
            // doc.data() is never undefined for query doc snapshots
            var mySubmissionRow = '<tr>\
               <th scope="row">'+count+'</th>\
               <td>\
               <strong>'+data.problemName+'</strong>\
               </td>\
               <td>\
                <h5>\
                <span class="badge badge-pill '+submissionBadegeClass+'">'+submissionStatus.description+'</span>\
                </h5>\
                </td>\
               <td>'+data.languageName+'</td>\
               <td>'+runTime+'</td>\
               <td>'+timeConverterUnixTOString(data.submissionTime)+'</td>\
           </tr>';

            $("#mySubmissionTableBody").append(mySubmissionRow);
            count++;
        });
         }, function(error) {
           console.log("Error getting documents: ", error);
         });

  }

  function getAllSubmission(contestIdRef){
      firestore.collection('contests').doc(contestIdRef)
      .collection("submissions").orderBy("submissionTime","desc")
      .onSnapshot(function(snapshot) {
        $("#allSubmissionTableBody").empty();
        var count = 1;
        snapshot.forEach(function(doc) {
          console.log(doc.data());
          var data = doc.data();
          var submissionStatus = data.status;
          var submissionStatusID = submissionStatus.id;
          var submissionBadegeClass ;
          var runTime ;
          if (submissionStatusID==3) {
            submissionBadegeClass = "badge-default";
            runTime = data.time;
          }
          else if (submissionStatusID==4) {
            submissionBadegeClass = "badge-danger";
            runTime = data.time;
          }
          else  {
            submissionBadegeClass =  "badge-warning";
            runTime ='<span class="badge badge-warning">\
            <i class="fas fa-times"></i></span>';

          }
            console.log(data.status.id);
            // doc.data() is never undefined for query doc snapshots
            var mySubmissionRow = '<tr>\
               <th scope="row">'+count+'</th>\
               <td>\
                <strong>'+data.problemName+'</strong>\
               </td>\
               <td>\
                <h5>\
                <span class="badge badge-pill '+submissionBadegeClass+'">'+submissionStatus.description+'</span>\
                </h5>\
                </td>\
               <td>'+data.languageName+'</td>\
               <td>'+runTime+'</td>\
               <td>'+timeConverterUnixTOString(data.submissionTime)+'</td>\
               <td>'+data.submitAuthorName+'</td>\
           </tr>';

            $("#allSubmissionTableBody").append(mySubmissionRow);
            count++;
        });

         }, function(error) {
           console.log("Error getting documents: ", error);
         });

  }

  function timeConverterUnixTOString(UNIX_timestamp){
    var a = new Date(UNIX_timestamp);
    var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var year = a.getFullYear();
    var month = months[a.getMonth()];
    var date = a.getDate();
    var hour = a.getHours();
    var min = a.getMinutes();
    var sec = a.getSeconds();
    var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec ;
    return time;
  }
  function getTimeRemainingd(penaltyTUnix) {
    var t = penaltyTUnix;
    var seconds = Math.floor((t / 1000) % 60);
    var minutes = Math.floor((t / 1000 / 60) % 60);
    var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
    var days = Math.floor(t / (1000 * 60 * 60 * 24));
    return {
      'total': t,
      'days': days,
      'hours': hours,
      'minutes': minutes,
      'seconds': seconds
    };
  }
</script>
<script>
  var stopFetch = false;
  var counterForJudge = 1;
  var isFinishedAllTestCaseJudge = false;
  var stopUpdateToFirestore = false;


  var snapSize;
  if (window.location.protocol !== "file:") {
    $("input[name=apiUrl]").attr('value', window.location.origin);
  }

  function createQueryParameters(type = "Request") {
    var parameters = [];
    parameters.push("base64_encoded=true");

    parameters.push("wait=false");

    if (parameters.length == 0) {
      return "";
    }

    var queryParameters = "?";
    for (var i = 0; i < parameters.length - 1; i++) {
      queryParameters += parameters[i] + "&";
    }

    return queryParameters + parameters[parameters.length - 1];
  }

  function resetButtons() {
    stopFetch = false;
    $("#submitProblemCode").removeAttr("disabled");
    // $("#stop").prop("disabled", true);
    // $("#panel").css('background-color', '#00F20D');
  }



  function handleError(jqXHR, textStatus, errorThrown) {
    resetButtons();
  }

  function fetchSubmission(apiUrl, token,testtags,languageId,languageName,problemIdRefs,problemName) {
    var queryParameters = createQueryParameters("Response");
    console.log("token "+token);

    $.ajax({
      url: apiUrl + "/submissions/" + token + queryParameters,
      type: "GET",
      async: true,
      success: function(data, textStatus, jqXHR) {
        console.log(textStatus);

        if ((data.status === undefined || data.status.id <= 2) && (data.status_id === undefined || data.status_id <= 2) && !stopFetch) {
          setTimeout(fetchSubmission.bind(null, apiUrl, token,testtags,languageId,languageName,problemIdRefs,problemName), 1500);
        } else if (!stopFetch) {
          var contestStartTimeDb;
          console.log(data);
          if(stopUpdateToFirestore==false){
            data.testCaseId = testtags;
            data.languageId = languageId;
            data.languageName = languageName;
            data.submitBy = getCurrentUserId();
            data.submitAuthorName = getUserName();
            data.problemId = problemIdRefs;
            data.problemName = problemName;

            firestore.collection("contests").doc(contestIdRef)
            .get().then(function(doc) {
                if (doc.exists) {
                    console.log("Document data:", doc.data().startTime);
                    contestStartTimeDb = doc.data().startTime;
                } else {
                    // doc.data() will be undefined in this case
                    console.log("No such document!");
                }
            }).catch(function(error) {
                console.log("Error getting document:", error);
            });

            if ((data.status.description != "Accepted")){
              console.log(data+"bipul d");
              var subTime = Date.parse(new Date());;
              data.submissionTime = subTime;
              console.log(testtags);;
                firestore.collection("contests").doc(contestIdRef)
                .collection("submissions")
                .add(data)
                .then(function(docRef) {
                    console.log("Document written with ID bipulsd: ", docRef.id);
                    updateContestStanding(contestIdRef,problemIdRefs,false,subTime,0,false,problemName);

                })
                .catch(function(error) {
                    console.error("Error adding document: ", error);
                });
             stopUpdateToFirestore = true;
             resetButtons();
           }
           console.log(counterForJudge + " " +snapSize);
            if(counterForJudge == snapSize){

              console.log(data+"bipul d");
              var subTime = Date.parse(new Date());;

              data.submissionTime = subTime;
                console.log(testtags);;

                firestore.collection("contests").doc(contestIdRef)
                .collection("submissions")
                .add(data)
                .then(function(docRef) {
                    console.log("Document written with ID bipulsd: ", docRef.id);
                    updateContestStanding(contestIdRef,problemIdRefs,true,subTime,contestStartTimeDb,true,problemName);

                })
                .catch(function(error) {
                    console.error("Error adding document: ", error);
                });
             stopUpdateToFirestore = true;
             resetButtons();
           }
          }
         counterForJudge += 1;
        } else {
          resetButtons();
        }
      },
      error: handleError
    });
  }

  $("#submitProblemCode").click(function() {
    $(this).prop("disabled", true);
    // $("#stop").removeAttr("disabled");
    $("#panel").css('background-color', '#F2000D');

    var apiUrl = " https://api.judge0.com";
    var sourceCode = $("textarea[name=sourceCode]").val();
    // var languageId = $("input[name=languageId]").val();
    counterForJudge = 1;
    stopUpdateToFirestore = false;

    var problemIdRefs = $('#contestProblemIdSelcetOpForSubmit').val();

    var problemName = $('#contestProblemIdSelcetOpForSubmit').find(":selected").text();

    console.log("bb id"+problemIdRefs);
    firestore.collection("problemsTest").doc(problemIdRefs).collection("problemTestCases")
    .get()
    .then(function(querySnapshot) {
        snapSize = querySnapshot.size;
        console.log(snapSize);
        var languageId = $('#allProblemLanguagesSubmitOption').find(":selected").val();
        var languageName = $('#allProblemLanguagesSubmitOption').find(":selected").text();
        querySnapshot.forEach(function(doc) {
            // doc.data() is never undefined for query doc snapshots
            if (stopUpdateToFirestore!=true) {
              var srcC = sourceCode;
              var numberOfRuns;
              var stdin ;
              var expectedOutput ;
              var cpuTimeLimit ;
              var cpuExtraTime ;
              var wallTimeLimit ;
              var memoryLimit ;
              var stackLimit ;
              var maxProcessesAndOrThreads ;
              var enablePerProcessAndThreadTimeLimit ;
              var enablePerProcessAndThreadMemoryLimit ;
              var maxFileSize =null;
              var wait = false;

              numberOfRuns = null;
              cpuTimeLimit = null;
              cpuExtraTime = null;
              wallTimeLimit = null;
              memoryLimit = null;
              stackLimit = null;

              maxProcessesAndOrThreads = null;
              enablePerProcessAndThreadTimeLimit = null;
              enablePerProcessAndThreadMemoryLimit = null;
              maxFileSize = null;

              var queryParameters = createQueryParameters();
              var firestoreData = doc.data();
              console.log(firestoreData);
              var testtags = firestoreData.testCaseTag;
              console.log(testtags+"hey bipul");
              console.log(firestoreData.testCaseInput+" "+firestoreData.testCaseOutput);
              stdin = btoa(firestoreData.testCaseInput);
              expectedOutput = btoa(firestoreData.testCaseOutput);


              var data = {
                source_code: btoa(srcC),
                language_id: languageId,
                number_of_runs: numberOfRuns,
                stdin: stdin,
                expected_output: expectedOutput,
                cpu_time_limit: cpuTimeLimit,
                cpu_extra_time: cpuExtraTime,
                wall_time_limit: wallTimeLimit,
                memory_limit: memoryLimit,
                stack_limit: stackLimit,
                max_processes_and_or_threads: maxProcessesAndOrThreads,
                enable_per_process_and_thread_time_limit: enablePerProcessAndThreadTimeLimit,
                enable_per_process_and_thread_memory_limit: enablePerProcessAndThreadMemoryLimit,
                max_file_size: maxFileSize
              };


              $.ajax({
                url: apiUrl + "/submissions" + queryParameters,
                type: "POST",
                async: true,
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function(data, textStatus, jqXHR) {

                  if (!wait) {
                    console.log("token "+data.token);

                    setTimeout(fetchSubmission.bind(null, apiUrl, data.token,testtags,languageId,languageName,problemIdRefs,problemName), 1500);
                  } else {

                    resetButtons();
                  }
                },
                error: handleError
              });

            console.log(doc.id, " => ", doc.data());

            }

        });
    })
    .catch(function(error) {
        console.log("Error getting documents: ", error);
    });


  });
  var datasb;
  // $("#stop").click(function() {
  //   stopFetch = true;
  // });
  function updateContestStanding(contestIdRef,problemId,mstatus,mtime,contestStartTimeDb,prbSNum,problemName){
    firestore.collection("contests").doc(contestIdRef)
    .collection("standings").doc(getCurrentUserId())
    .get().then(function(doc) {
      console.log(mtime+"0");
      var tagNum = problemName.split(".");
      tagNum = tagNum[0];
      if (doc.exists) {
          var data = doc.data();
          if ( typeof data.problemDetails[problemId] == 'undefined') {
            var solved ;
            var penalty;
            if(mstatus){
              var penaltyTUnix = mtime - contestStartTimeDb;
              var penaltyOBJ = getTimeRemainingd(penaltyTUnix);
              var pT =(penaltyOBJ.days*24*60)+ (penaltyOBJ.hours * 60) + penaltyOBJ.minutes;
              penalty = data.penalty+pT;
              solved = data.solved+1;
            }else{
              solved = data.solved;
              penalty = data.penalty;
            }
            console.log("fuck it life");
            firestore.collection("contests").doc(contestIdRef)
            .collection("standings").doc(getCurrentUserId()).
            update({
              ['problemDetails.'+problemId] :{
                        status : mstatus,
                        trying : 1,
                        problemTag : tagNum,
                        time : mtime
            },
            solved : data.solved+1,
            penalty : penalty});
          }
          else{
            var solved ;
            var penalty;
            console.log("Document data:bbipul", data.problemDetails[problemId].trying);
            if(data.problemDetails[problemId].status && mstatus){
              solved = data.solved;
            }else if(data.problemDetails[problemId].status && mstatus==false){
              solved = data.solved-1;
            }else if(data.problemDetails[problemId].status == false && mstatus){
              solved = data.solved+1;
            }else if(data.problemDetails[problemId].status == false && mstatus == false){
              solved = data.solved;
            }

            if(mstatus){
              var penaltyTUnix = mtime - contestStartTimeDb;
              var penaltyOBJ = getTimeRemainingd(penaltyTUnix);
              var pT =(penaltyOBJ.days*24*60)+ (penaltyOBJ.hours * 60) + penaltyOBJ.minutes;
              penalty = pT+(data.problemDetails[problemId].trying+1)*20;
            }else{
              penalty = data.penalty;
            }
            firestore.collection("contests").doc(contestIdRef)
            .collection("standings").doc(getCurrentUserId()).
            update({
              ['problemDetails.'+problemId] :{
                status : mstatus,
                trying : data.problemDetails[problemId].trying+1,
                problemTag : data.problemDetails[problemId].problemTag,
                time : mtime
            },
            solved : solved,
            penalty : penalty});
          }


      } else {
          // doc.data() will be undefined in this case
          console.log(mtime+"1");
          var penalty;
          if(mstatus){
            var penaltyTUnix = mtime - contestStartTimeDb;
            var penaltyOBJ = getTimeRemainingd(penaltyTUnix);
            penalty =(penaltyOBJ.days*24*60)+ (penaltyOBJ.hours * 60) + penaltyOBJ.minutes;
          }else {
            penalty = 0;
          }
          console.log(penalty+" bipul mandol");
          addStanding(problemId,mstatus,mtime,penalty,prbSNum,tagNum);
      }
    }).catch(function(error) {
      console.log("Error getting document:", error);
    });
  }
  function addStanding(problemId,mstatus,mtime,penalty,prbSNum,tagNum) {
    console.log(penalty+" bipul mandol2");

    var dataStanding = {
            userId: getCurrentUserId(),
            userName : getUserName(),
            penalty : penalty,
            problemDetails : {
            }
    };
    if(prbSNum){
      dataStanding.solved = 1;
    }else{
      dataStanding.solved = 0;
    }
    dataStanding.problemDetails[problemId] ={
                status : mstatus,
                trying : 1,
                problemTag : tagNum,
                time : mtime
    };
    console.log(mtime);

    firestore.collection("contests").doc(contestIdRef)
    .collection("standings").doc(getCurrentUserId())
    .set(dataStanding)
    .then(function() {
        console.log("Document successfully written!");
    })
    .catch(function(error) {
        console.error("Error writing document: ", error);
    });
  }

  function hasPath(obj, path) {
    if (typeof obj == 'undefined')
        return false;
    var propName = path.shift();
    if ( obj.hasOwnProperty(propName) ) {
        if ( path.length == 0 )
            return true;
        else
            return hasPath(obj[propName], path);
    }
    return false;
  }
  var standingObj;
  function updateSatndingTableData() {
    var problemNumberHeader = {};
    firestore.collection('contests').doc(contestIdRef)
    .collection("contestProblems")
    .onSnapshot(function(snapshot) {
      $("#standingTableHeader").empty();
      var row ='<th scope="col">#</th>\
            <th scope="col">Contestant</th>\
            <th scope="col">Solved problem</th>\
            <th scope="col">Penalty</th>';
      $("#standingTableHeader").append(row);
      var problemHCOunt = 65;
      snapshot.forEach(function(doc) {
          problemNumberHeader[String.fromCharCode(problemHCOunt)] = '<td class="pt-3">\
                    <span class="text-success">\
                      <i class="far fa-question-circle"></i>\
                    </span>\
                </td>';
          var rowHeader = '<th scope="col">'+String.fromCharCode(problemHCOunt);+'</th>';
          $("#standingTableHeader").append(rowHeader);
          problemHCOunt++;
          console.log("hello bb node");
      });
    });

      firestore.collection('contests').doc(contestIdRef)
      .collection("standings")
      .orderBy("solved","desc").orderBy("penalty")
      .onSnapshot(function(snapshot) {
        $("#standingTableBody").empty();
        var count = 1;
        snapshot.forEach(function(doc) {

          for (const [key, value] of Object.entries(problemNumberHeader)) {
            problemNumberHeader[key] = '<td class="pt-3">\
                      <span class="text-success">\
                        <i class="far fa-question-circle"></i>\
                      </span>\
                  </td>';
          }

          var rowObjectStanding = {};
          console.log(doc.data());
          var data = doc.data();
          var standingObj = data.problemDetails;
          var objectArray = Object.keys(standingObj).map(function(key, index){
              var res = new Array(2);
              res[0] = key;
              res[1] = standingObj[key].problemTag;
              res[2] = standingObj[key].trying;
              res[3] = standingObj[key].status;
              res[4] = standingObj[key].time;
              return res;
          });
          var problemNameRow="";
          console.log(objectArray.length);
              objectArray.forEach(function (item){
                    var time = getTimeRemainingd(item[4]);

                    if(item[3]){
                      problemNameRow += '<td class="pt-3">\
                                <span class="text-success">\
                                  <i class="fas fa-check-circle text-success mr-1"></i>\
                                  '+item[2]+'\
                                </span>\
                                <p>'+time.hours+":"+time.minutes+'</p>\
                            </td>';

                    }else{
                      problemNameRow += '<td class="pt-3">\
                                <span class="text-danger">\
                                  <i class="fas fa-minus-circle text-danger mr-1"></i>\
                                  '+item[2]+'\
                                </span>\
                                <p>'+time.hours+":"+time.minutes+'</p>\
                            </td>';
                    }

                  console.log(item);
                  problemNumberHeader[item[1]] = problemNameRow;
                });


          var problemDataTableRow="";
          for (const [key, value] of Object.entries(problemNumberHeader)) {
            problemDataTableRow += value;
          }


          var row = '<tr>\
              <th scope="row" class="pt-4">'+count+'</th>\
              <td class="pt-4">'+data.userName+'</td>\
              <td class="pt-4">'+data.solved+'</td>\
              <td class="pt-4">'+data.penalty+'</td>'+problemDataTableRow+'\
            </tr>';
            $("#standingTableBody").append(row);
            count++;
        });

         }, function(error) {
           console.log("Error getting documents: ", error);
         });
  }
</script>
</body>

</html>
