<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" href="assets/images/becoder.png" type="image/gif" sizes="16x16">
  <title>becoder</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
  <!-- Bootstrap core CSS -->
  <link href="assets/library/mdb/css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="assets/library/mdb/css/mdb.min.css" rel="stylesheet">
  <link href="assets/css/becoder.css" rel="stylesheet">

  <!-- JQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Bootstrap tooltips -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="assets/library/mdb/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="assets/library/mdb/js/mdb.min.js"></script>

<!--  firebase config-->
    <script src="/__/firebase/5.6.0/firebase-app.js"></script>
    <script src="/__/firebase/5.6.0/firebase-auth.js"></script>
    <script src="/__/firebase/5.6.0/firebase-firestore.js"></script>
    <script src="/__/firebase/5.6.0/firebase-storage.js"></script>
    <script src="/__/firebase/5.6.0/firebase-messaging.js"></script>
    <!--  firebase config-->
<script src="/__/firebase/init.js"></script>
<script type="text/javascript" src="bin/becoder.js"></script>


</head>
    <body class="grey lighten-3">

  <!--Main Navigation-->
  <header>
    <!--Navbar-->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-blue scrolling-navbar">
      <a class="navbar-brand" href="index.html">
        <img src="assets/images/becoder.png" width="30" height="30" class="d-inline-block align-top" alt="">
      </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#becoderNavbarToggle" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="becoderNavbarToggle">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
              <li class="nav-item active">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Practice</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="contests.html">Contests</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Resource</a>
              </li>
              <li class="nav-item" style="padding-right:20px;padding-left:20px">

              </li>

            </ul>
            <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                <a class="nav-link" href="#">Leaderboard</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Notifications</a>
              </li>

              <li class="nav-item" id="navbar-login-signin-button" hidden>
                <a class="nav-link" data-toggle="modal" data-target="#modalLRForm" href="#">Login/Register</a>
              </li>

              <li class="nav-item dropdown" id="navbar-user-item" hidden>
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <img id="nav-user-pic" width="30" height="30" class="d-inline-block align-top" alt="">
                  <span id="nav-user-name">becoder</span></a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="#">Ranking</a>
                  <a class="dropdown-item" href="userProfile.html">Profile</a>
                  <a class="dropdown-item" href="#">Submission</a>
                  <a class="dropdown-item" href="#">Note</a>
                  <a class="dropdown-item" href="#">Setting</a>
                  <a class="dropdown-item" href="administration/contests.html">Administration</a>
                  <a class="dropdown-item" id="logout" href="#">Logout</a>

                </div>
              </li>
            </ul>
          </div>
        </nav>
    <!--/.Navbar-->

    </header>


    <!--Modal: Login / Register Form-->
  <div class="modal fade" id="modalLRForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog cascading-modal" role="document">
    <!--Content-->
    <div class="modal-content">

      <!--Modal cascading tabs-->
      <div class="modal-c-tabs">

        <!-- Nav tabs -->
        <ul class="nav nav-tabs md-tabs tabs-2 light-blue darken-3" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#panel7" role="tab"><i class="fas fa-user mr-1"></i>
              Login</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#panel8" role="tab"><i class="fas fa-user-plus mr-1"></i>
              Register</a>
          </li>
        </ul>

        <!-- Tab panels -->
        <div class="tab-content">
          <!--Panel 7-->
          <div class="tab-pane fade in show active" id="panel7" role="tabpanel">

            <!--Body-->
            <div class="modal-body mb-1">
              <div class="md-form form-sm mb-5">
                <i class="fas fa-envelope prefix"></i>
                <input type="email" placeholder="email or username" id="user-sign-in-email" class="form-control form-control-sm validate">
              </div>

              <div class="md-form form-sm mb-4">
                <i class="fas fa-lock prefix"></i>
                <input type="password" placeholder="password" id="user-sign-in-password" class="form-control form-control-sm validate">
              </div>
              <div class="text-center mt-2">
                <button class="btn btn-info"  id= "sign-in-with-email" >Log in <i class="fas fa-sign-in ml-1"></i></button>
              </div>
            </div>
            <!--Footer-->
            <div class="login_connect_with">
                Or Connect With
              </div>
            <!--Footer-->
            <div class="modal-footer">
              <div class="social">
                <a class="circle github" href="#">
                    <i class="fab fa-github"></i>
                </a>
                <a id="google_login" class="circle google" href="#">
                    <i class="fab fa-google"></i>
                </a>
                <a id="facebook_login" class="circle facebook" href="#">
                    <i class="fab fa-facebook-f"></i>
                </a>
            </div>
            </div>

          </div>
          <!--/.Panel 7-->

          <!--Panel 8-->
          <div class="tab-pane fade" id="panel8" role="tabpanel">

            <!--Body-->
            <div class="modal-body">
              <div class="md-form form-sm mb-5">
                <i class="fas fa-envelope prefix"></i>
                <input type="email" placeholder="email" id="user-sign-up-email" class="form-control form-control-sm validate">

              </div>
              <div class="md-form form-sm mb-5">
                <i class="fas fa-user prefix"></i>
                <input type="text" placeholder="username" id="user-sign-up-username" class="form-control form-control-sm validate">

              </div>
              <div class="md-form form-sm mb-5">
                <i class="fas fa-lock prefix"></i>
                <input type="password" placeholder="password" id="user-sign-up-password" class="form-control form-control-sm validate">

              </div>

              <div class="md-form form-sm mb-4">
                <i class="fas fa-lock prefix"></i>
                <input type="password" placeholder="Repeat password" id="modalLRInput14" class="form-control form-control-sm validate">
              </div>
            <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="defaultUnchecked">
                <label class="custom-control-label" for="defaultUnchecked">Accept the<a href="#" class="green-text font-weight-bold">
                              Terms and Conditions</a></label>
            </div>
              <div class="text-center form-sm mt-2">
                <button class="btn btn-info" id="sign-up-with-email">Sign up <i class="fas fa-sign-in ml-1"></i></button>
              </div>

            </div>
              <div class="login_connect_with">
                Or Connect With
              </div>
            <!--Footer-->
            <div class="modal-footer">
              <div class="social">
                <a class="circle github" href="#">
                    <i class="fab fa-github"></i>
                </a>
                <a id="google_login" class="circle google" href="#">
                    <i class="fab fa-google"></i>
                </a>
                <a id="facebook_login" class="circle facebook" href="#">
                    <i class="fab fa-facebook-f"></i>
                </a>
            </div>
            </div>
          </div>
          <!--/.Panel 8-->
        </div>

      </div>
    </div>
    <!--/.Content-->
  </div>
</div>
<!--Modal: Login / Register Form-->
<div >

<img src="https://firebasestorage.googleapis.com/v0/b/becoder-91007.appspot.com/o/contestLandingPageBackground%2FrnOSnXYskiw3R75VG3y7?alt=media&token=52db2c50-2281-4b85-8a09-dffd789fd1d9" />

  <strong>API URL</strong>&nbsp
  <input type="url" name="apiUrl" value=" https://api.judge0.com" size="31" placeholder="https://api.judge0.com"><br><br>

  <strong>Source Code</strong>
  <textarea name="sourceCode" rows="10" cols="50">
#include <stdio.h>

int main(void) {
  char name[10];
  scanf("%s", name);
  printf("hello, %s\n", name);
  return 0;
}</textarea><br><br>
  <strong>Language ID</strong>&nbsp
  <input type="text" name="languageId" value="4">
  <input type="checkbox" name="languageIdIsNull"><code>null</code><br><br>

  <strong>Stdin</strong>
  <input type="checkbox" name="stdinIsNull"><code>null</code><br>
  <textarea name="stdin" rows="5" cols="25">Judge0</textarea><br><br>

  <strong>Expected Output</strong>
  <input type="checkbox" name="expectedOutputIsNull"><code>null</code><br>
  <textarea name="expectedOutput" rows="5" cols="25">hello, Judge0</textarea><br><br>



  <div id="panel" style="position: fixed; bottom: 0px; padding: 20px; background-color: #00F20D; bottom: 20px; right: 20px; border: 1px solid #777">
    <button type="button" id="run">Run</button>
    <button type="button" id="stop" disabled>Stop</button>
    <button type="button" id="clearLog">Clear Log</button>
    <button type="button" id="backToTop">Back To Top</button>
  </div>

  <hr>

  <h2>Request/Response Log</h2><br>
  <pre id="log"></pre>

  <script>
  var datas;
    var stopFetch = false;

    if (window.location.protocol !== "file:") {
      $("input[name=apiUrl]").attr('value', window.location.origin);
    }

    function createQueryParameters(type = "Request") {
      var parameters = [];
      parameters.push("base64_encoded=true");

      parameters.push("wait=false");

      if (parameters.length == 0) {
        return "";
      }

      var queryParameters = "?";
      for (var i = 0; i < parameters.length - 1; i++) {
        queryParameters += parameters[i] + "&";
      }

      return queryParameters + parameters[parameters.length - 1];
    }

    function resetButtons() {
      stopFetch = false;
      $("#run").removeAttr("disabled");
      $("#stop").prop("disabled", true);
      $("#panel").css('background-color', '#00F20D');
    }



    function handleError(jqXHR, textStatus, errorThrown) {
      resetButtons();
    }

    function fetchSubmission(apiUrl, token) {
      var queryParameters = createQueryParameters("Response");
      $.ajax({
        url: apiUrl + "/submissions/" + token + queryParameters,
        type: "GET",
        async: true,
        success: function(data, textStatus, jqXHR) {
          console.log(textStatus);

          if ((data.status === undefined || data.status.id <= 2) && (data.status_id === undefined || data.status_id <= 2) && !stopFetch) {
            setTimeout(fetchSubmission.bind(null, apiUrl, token), 1500);
          } else if (!stopFetch) {
            datas = data;
            data.testCaseNumber = 2
            console.log(data);
            if (data.status.description != "Accepted") {
              firestore.collection("submission").add(data)
              .then(function(docRef) {
                  console.log("Document written with ID: ", docRef.id);
              })
              .catch(function(error) {
                  console.error("Error adding document: ", error);
              });
            }
            resetButtons();
          } else {
            resetButtons();
          }
        },
        error: handleError
      });
    }

    $("#run").click(function() {
      $(this).prop("disabled", true);
      $("#stop").removeAttr("disabled");
      $("#panel").css('background-color', '#F2000D');

      var apiUrl = " https://api.judge0.com";
      var sourceCode = $("textarea[name=sourceCode]").val();
      // var languageId = $("input[name=languageId]").val();
      var languageId = 4;
      var numberOfRuns;
      var stdin = $("textarea[name=stdin]").val();
      var expectedOutput = $("textarea[name=expectedOutput]").val();
      var cpuTimeLimit ;
      var cpuExtraTime ;
      var wallTimeLimit ;
      var memoryLimit ;
      var stackLimit ;
      var maxProcessesAndOrThreads ;
      var enablePerProcessAndThreadTimeLimit ;
      var enablePerProcessAndThreadMemoryLimit ;
      var maxFileSize =null;
      var wait = false;

      var queryParameters = createQueryParameters();
        sourceCode = btoa(sourceCode);
        stdin = btoa(stdin);
        expectedOutput = btoa(expectedOutput);


      numberOfRuns = null;
      cpuTimeLimit = null;
      cpuExtraTime = null;
      wallTimeLimit = null;
      memoryLimit = null;
      stackLimit = null;

      maxProcessesAndOrThreads = null;
      enablePerProcessAndThreadTimeLimit = null;
      enablePerProcessAndThreadMemoryLimit = null;

      if ($("input[name=maxFileSizeIsNull]").is(":checked")) {
        maxFileSize = null;
      }

      var data = {
        source_code: sourceCode,
        language_id: languageId,
        number_of_runs: numberOfRuns,
        stdin: stdin,
        expected_output: expectedOutput,
        cpu_time_limit: cpuTimeLimit,
        cpu_extra_time: cpuExtraTime,
        wall_time_limit: wallTimeLimit,
        memory_limit: memoryLimit,
        stack_limit: stackLimit,
        max_processes_and_or_threads: maxProcessesAndOrThreads,
        enable_per_process_and_thread_time_limit: enablePerProcessAndThreadTimeLimit,
        enable_per_process_and_thread_memory_limit: enablePerProcessAndThreadMemoryLimit,
        max_file_size: maxFileSize
      };


      $.ajax({
        url: apiUrl + "/submissions" + queryParameters,
        type: "POST",
        async: true,
        contentType: "application/json",
        data: JSON.stringify(data),
        success: function(data, textStatus, jqXHR) {

          if (!wait) {
            setTimeout(fetchSubmission.bind(null, apiUrl, data.token), 1500);
          } else {

            resetButtons();
          }
        },
        error: handleError
      });
    });

    $("#stop").click(function() {
      stopFetch = true;
    });

    $("#clearLog").click(function() {
      $("#log").html("");
    });

    $("#backToTop").click(function() {
      $('html, body').animate({
		      scrollTop: 0
	    }, 50);
    });











    $("#addProblemToContestInput").keypress(function(){
      console.log("hello");

      $("#addProblmProblemList").removeAttr("hidden");
      $("#addProblmProblemList").show();
    });
    $("body").click(function(){
      $("#addProblmProblemList").attr("hidden",true);
    });


    $("#addProblemToContestInput").keyup(function(){
      $("#searchmoderatorsname").removeAttr("hidden");
      $("#addProblmProblemList").show();
      console.log("hello b");
      var searchUsernameQuery =  $("#addProblemToContestInput").val();
      searchUserFromDbByUsername(searchUsernameQuery,"queries[1]");

    });


    function searchProblemByName(queryProblemname,contestIdRef){
      queryProblemname = queryProblemname.toLowerCase();
      var limitChar = String.fromCharCode(queryProblemname.charCodeAt(0)+1);

      firestore.collection('problemsTest').where('problemName', '>=', queryProblemname).where('problemName','<=',limitChar)
      .get()
      .then(function(querySnapshot) {
        $("#addProblmProblemList").empty();
        console.log("hello bb");
          querySnapshot.forEach(function(doc) {
            var data = doc.data();
              // doc.data() is never undefined for query doc snapshots
              var listItem = '<div class="list-group-item notopbottom z-depth-5 " id="'+doc.id+'"> \
                <p class="mt-2" style="margin-left:10px!important;display:inline-block;"> <strong>'+data.problemName+'</strong>\
                <button style="margin-left:15px;" id="addingProblemToContest'+doc.id+'" class="btn btn-default btn-sm">Add</button> </p> \
              </div>' ;
              console.log(doc.id, " => ", listItem);
              $("#searchmoderatorsname").append(listItem);
              $("#addingProblemToContest"+doc.id).click(function(){
              var addProblemToConOBJ = {
                   contestProblemId : doc.id,
                   problemCreatorAuthorId: data.problemCreatorAuthorId,
                   problemName : data.problemName,
                   problemAuthorName : data.problemAuthorName
                };
                firestore.collection("contests").doc(contestIdRef).collection("contestProblems").doc(doc.id).set(addProblemToConOBJ)
                .then(function(docRef) {
                    console.log("Document written with ID bbj fuck: ", "docRef.id");
                })
                .catch(function(error) {
                    console.error("Error adding document: ", error);
                });



              });

          });
      })
      .catch(function(error) {
          console.log("Error getting documents: ", error);
      });
    }


    function listenForNewProblemAddToContest(mcontestIdref){

      firestore.collection("contests").doc(mcontestIdref).collection("contestProblems")
      .onSnapshot(function(querySnapshot) {
        $("#contestProblemListTableBody").empty();
        var count = 1;
        querySnapshot.forEach(function(doc) {
          var data = doc.data();
          var problemTableRow = '<tr>\
            <td>'+count+'</td>\
            <td>'+data.problemName+'</td>\
            <td id="problemAu'+data.problemCreatorAuthorId+'">'+data.problemAuthorName+'</td>\
          </tr>';
            $("#contestProblemListTableBody").append(problemTableRow);

            $("#problemAu"+data.problemCreatorAuthorId).click(function(){
              location.href = "../userProfile.html?"+data.problemCreatorAuthorId;
            });
       });

    });
  }

  </script>
</body>
</html>
